<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–í–∏–¥–∂–µ—Ç –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞</title>
    <style>
        /* –°–∫—Ä—ã—Ç—ã–π –≤–∏–¥–∂–µ—Ç —á–∞—Ç–∞ */
        #chatWidget {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 300px;
        height: 400px;
        background-color: white;
        box-shadow: 0 0 10px rgba(0,0,0,0.2);
        border-radius: 8px;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        z-index: 9999;
        transition: transform 0.3s ease;
        transform: translateY(100%);
        }

        #chatWidget.open {
        transform: translateY(0);
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∏–¥–∂–µ—Ç–∞ */
        #chatHeader {
        background-color: #007bff;
        color: white;
        padding: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        }

        #chatHeader button {
        background: none;
        border: none;
        color: white;
        font-size: 18px;
        cursor: pointer;
        }

        /* –û–±–ª–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π */
        #chatMessages {
        flex: 1;
        padding: 10px;
        overflow-y: auto;
        background-color: #f9f9f9;
        }

        .message {
        margin: 5px 0;
        padding: 8px 10px;
        background-color: #e9ecef;
        border-radius: 5px;
        max-width: 80%;
        }

        .message.you {
        align-self: flex-end;
        background-color: #d4edda;
        }

        .message.bot {
        align-self: flex-start;
        background-color: #e2e3e5;
        }

        /* –§–æ—Ä–º–∞ –≤–≤–æ–¥–∞ */
        #chatInputArea {
        display: flex;
        padding: 10px;
        background-color: #f8f9fa;
        border-top: 1px solid #ccc;
        }

        #chatInput {
        flex: 1;
        padding: 8px;
        font-size: 14px;
        border: 1px solid #ccc;
        border-radius: 4px;
        }

        #chatSendBtn {
        padding: 8px 12px;
        font-size: 14px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        margin-left: 8px;
        cursor: pointer;
        }

        #chatSendBtn:hover {
        background-color: #0056b3;
        }

        /* –ö–Ω–æ–ø–∫–∞ —á–∞—Ç–∞ (–∏–∫–æ–Ω–∫–∞) */
        #chatToggleBtn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 60px;
        height: 60px;
        background-color: #007bff;
        border-radius: 50%;
        box-shadow: 0 0 10px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        cursor: pointer;
        z-index: 9998;
        transition: background-color 0.3s ease;
        }

        #chatToggleBtn:hover {
        background-color: #0056b3;
        }
    </style>
</head>
<body>

<!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –≤–∏–¥–∂–µ—Ç–∞ -->
<div id="chatToggleBtn" onclick="toggleChat()">üí¨</div>

<!-- –í–∏–¥–∂–µ—Ç —á–∞—Ç–∞ -->
<div id="chatWidget">
    <div id="chatHeader">
        <span>Core messenger</span>
        <button onclick="toggleChat()">‚úñ</button>
    </div>
    <div id="chatMessages"></div>
    <div id="chatInputArea">
        <input type="text" id="chatInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."/>
        <button id="chatSendBtn" onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </div>
</div>

<script>
    const widget = document.getElementById('chatWidget');
    const messages = document.getElementById('chatMessages');
    const input = document.getElementById('chatInput');

    function toggleChat() {
    widget.classList.toggle('open');
    }

    function sendMessage() {
    const text = input.value.trim();
    if (text === '') return;

    const message = document.createElement('div');
    message.classList.add('message', 'you');
    message.textContent = text + ' (' + new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) +
    ')';
    messages.appendChild(message);

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ localStorage
    saveMessage(text, 'you');

    input.value = '';
    messages.scrollTop = messages.scrollHeight;

    // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
    setTimeout(() => {
    const botMessage = document.createElement('div');
    botMessage.classList.add('message', 'bot');
    botMessage.textContent = '–í—ã –Ω–∞–ø–∏—Å–∞–ª–∏: ' + text + ' (' + new Date().toLocaleTimeString([], { hour: '2-digit',
    minute: '2-digit' }) + ')';
    messages.appendChild(botMessage);
    saveMessage(botMessage.textContent, 'bot');
    messages.scrollTop = messages.scrollHeight;
    }, 500);
    }

    function saveMessage(text, type) {
    const history = JSON.parse(localStorage.getItem('chatHistory') || '[]');
    history.push({ type, text });
    localStorage.setItem('chatHistory', JSON.stringify(history));
    }

    function loadMessages() {
    const history = JSON.parse(localStorage.getItem('chatHistory') || '[]');
    history.forEach(msg => {
    const message = document.createElement('div');
    message.classList.add('message', msg.type);
    message.textContent = msg.text;
    messages.appendChild(message);
    });
    messages.scrollTop = messages.scrollHeight;
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
    document.getElementById('chatToggleBtn').addEventListener('click', () => {
    if (!widget.classList.contains('open')) {
    loadMessages();
    }
    });
</script>

</body>
</html>
