
---

### ADR-003: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
**–°—Ç–∞—Ç—É—Å**: –ü—Ä–∏–Ω—è—Ç–æ  
**–î–∞—Ç–∞**: 2025-09-03  
**–£—á–∞—Å—Ç–Ω–∏–∫–∏**: Lead Architect, Backend Engineer, QA Engineer

#### 1. –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏ –ø—Ä–æ–±–ª–µ–º–∞
> "–ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥–ª–∏ –≤–∏–¥–µ—Ç—å —Å—Ç–∞—Ç—É—Å '–ü—Ä–æ—á–∏—Ç–∞–Ω–æ' –∏ '–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ', –∏ —á—Ç–æ–±—ã —ç—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º B2B-—Å–µ–≥–º–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è CRM, –ø–æ–¥–¥–µ—Ä–∂–∫–∏, –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π)?"

#### 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –∑–Ω–∞—á–∏–º—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (ASR)

| ID —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è | –¢–µ–∫—Å—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è | –¢–∏–ø | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|---------------|------------------|-----|----------|
| READ-001 | –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ñ–∞–∫—Ç –ø—Ä–æ—á—Ç–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π | –§–¢ | –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ US-005 |
| READ-002 | –°—Ç–∞—Ç—É—Å –ø—Ä–æ—á—Ç–µ–Ω–∏—è –¥–æ–ª–∂–µ–Ω –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ | –§–¢ | –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ US-007 |
| READ-003 | –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ, –ø—Ä–æ—á–∏—Ç–∞–Ω–æ) | –§–¢ | –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ US-001 |
| AUDIT-003 | –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è | –ù–§–¢ | –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ US-010 |
| PERF-004 | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–µ –¥–æ–ª–∂–Ω–æ –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–∞—Ç–∞ | –ù–§–¢ | –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ US-006 |
| SCAL-007 | –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–æ 50 000 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –ù–§–¢ | –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ US-008 |

#### 3. –ê–Ω–∞–ª–∏–∑ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ \ –†–µ—à–µ–Ω–∏–µ | REST polling | Long polling | **WebSocket + Event Bus** | Server-Sent Events |
|----------------------|--------------|----------------|--------------------------|---------------------|
| **READ-001**         | ‚úÖ           | ‚úÖ             | ‚úÖ                       | ‚úÖ                  |
| **READ-002**         | ‚ùå           | ‚ö†Ô∏è             | ‚úÖ                       | ‚ö†Ô∏è                  |
| **READ-003**         | ‚ö†Ô∏è           | ‚ö†Ô∏è             | ‚úÖ                       | ‚úÖ                  |
| **AUDIT-003**        | ‚ö†Ô∏è           | ‚ö†Ô∏è             | ‚úÖ                       | ‚ö†Ô∏è                  |
| **PERF-004**         | ‚ùå           | ‚ö†Ô∏è             | ‚úÖ                       | ‚úÖ                  |
| **SCAL-007**         | ‚ùå           | ‚ö†Ô∏è             | ‚úÖ                       | ‚ö†Ô∏è                  |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** | ‚ö†Ô∏è        | ‚ö†Ô∏è             | ‚úÖ                       | ‚ùå                  |

#### 4. –í—ã–±—Ä–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ WebSocket –∏ Event Bus**:

- **Frontend**:
    - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ `messageRead` –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞ –∏–ª–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ –¥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
    - –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –ø—Ä–æ—á—Ç–µ–Ω–∏—è —á–µ—Ä–µ–∑ WebSocket

- **Backend**:
    - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ `messageRead(chat_id, message_id, user_id)`
    - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –≤ –ë–î (—Ç–∞–±–ª–∏—Ü–∞ `message_read_status`)
    - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WebSocket –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º —á–∞—Ç–∞

- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**:
    - **WebSocket** –¥–ª—è –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π —Å–≤—è–∑–∏ —Å –∫–ª–∏–µ–Ω—Ç–æ–º
    - **Kafka** –∏–ª–∏ **RabbitMQ** –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π
    - **Redis** –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—É—â–∏—Ö —Å–µ—Å—Å–∏–π –∏ —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞

- **–°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö**:
    ```sql
    CREATE TABLE message_read_status (
        id SERIAL PRIMARY KEY,
        message_id UUID NOT NULL REFERENCES messages(id),
        user_id UUID NOT NULL REFERENCES users(id),
        read_at TIMESTAMP NOT NULL DEFAULT NOW(),
        is_read BOOLEAN NOT NULL DEFAULT TRUE
    );
    ```

#### 5. –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

–í—ã–±—Ä–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:
- **–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏—è** —á–µ—Ä–µ–∑ WebSocket (READ-002)
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏—Ç** —á–µ—Ä–µ–∑ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ `message_read_status` (AUDIT-003)
- **–ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –±–ª–∞–≥–æ–¥–∞—Ä—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ (PERF-004)
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ** –∑–∞ —Å—á—ë—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Event Bus –∏ Redis (SCAL-007)

#### 6. –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è

- ‚úÖ **–ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ**:
    - –ü–æ–≤—ã—à–µ–Ω–∏–µ UX –∑–∞ —Å—á—ë—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ B2B-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç)
    - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (–∫—Ç–æ, –∫–æ–≥–¥–∞ –∏ —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—á–∏—Ç–∞–ª)

- ‚ö†Ô∏è **–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ**:
    - –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ç—å –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π
    - –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º WebSocket-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

- üîß **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
    - ADR-001: –Ø–¥—Ä–æ-–¥–≤–∏–∂–æ–∫ —á–∞—Ç–æ–≤
    - ADR-002: –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
    - ADR-007: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞—É–¥–∏—Ç

#### 7. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –ú–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ | –†–µ–∑—É–ª—å—Ç–∞—Ç | –°—Ç–∞—Ç—É—Å |
|------------|----------------|-----------|--------|
| READ-001 | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã | –°—Ç–∞—Ç—É—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è | ‚úÖ |
| READ-002 | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ WebSocket | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞ <100–º—Å | ‚úÖ |
| READ-003 | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ UI | –°—Ç–∞—Ç—É—Å—ã "–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ", "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ" –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è | ‚úÖ |
| AUDIT-003 | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ | –í—Å–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–æ—á—Ç–µ–Ω–∏—è –∑–∞–ø–∏—Å–∞–Ω—ã | ‚úÖ |
| PERF-004 | –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 0% –≤–ª–∏—è–Ω–∏—è –Ω–∞ TPS | ‚úÖ |
| SCAL-007 | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ 10 000 –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π | –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ | ‚úÖ |

---
