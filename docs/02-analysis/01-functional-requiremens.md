
---

### Таблица функциональных требований — Ядро-движок чатов

| ID     | Название                      | Описание                                                                                                                               | Источник               | Приоритет | Критерии приемки                                                                                                                                                             | Связанные модули          |
|--------|-------------------------------|----------------------------------------------------------------------------------------------------------------------------------------|------------------------|-----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|
| **FR-001** | Создание чата                 | Система позволяет создавать новый чат между двумя или более участниками                                                                  | US-001 (пользователь)  | Must      | При нажатии "Новый чат" с участниками A и B: создается уникальный чат с историей сообщений. Система возвращает ID чата и список участников                                      | Чаты, Пользователи        |
| **FR-002** | Удаление чата                | Система позволяет удалить чат, включая все сообщения и метаданные                                                                          | US-002 (админ)         | Must      | При удалении чата через API или UI: чат удаляется у всех участников. Логи и данные не восстанавливаются при последующих запросах                                                 | Чаты, Безопасность        |
| **FR-003** | Отправка сообщений           | Система позволяет отправлять текстовые сообщения, с прикреплением файлов и медиа                                                           | US-003 (пользователь)  | Must      | Пользователь отправляет сообщение "Привет" и файл .pdf (≤10 МБ). Сообщение появляется у получателя в течение 2 секунд. Файл доступен для скачивания                              | Чаты, Файлы               |
| **FR-004** | Хранение истории сообщений    | Система хранит историю сообщений чата в базе данных с возможностью её получения                                                           | US-004 (пользователь)  | Must      | При повторном открытии чата: отображаются все предыдущие сообщения. История доступна в течение 5 лет                                                                           | Чаты, Хранилище           |
| **FR-005** | Уведомления о прочитанности| Система отслеживает, прочитано ли сообщение, и отправляет уведомление об этом                                                             | US-005 (пользователь)  | Must      | После прочтения сообщения в чате: у отправителя появляется метка "Прочитано". Уведомление отправляется в течение 1 секунды                                                      | Чаты, Уведомления         |
| **FR-006** | Поддержка разных типов чатов| Система поддерживает разные типы чатов: 1:1, групповые, публичные, приватные                                                            | US-006 (архитектор)    | Must      | При создании чата можно указать тип. Каждый тип имеет свои параметры (например, ограничение на кол-во участников, права на добавление новых участников и т.д.)                   | Чаты, RBAC                |
| **FR-007** | Расширяемая логика чатов    | Система позволяет добавлять кастомную логику в чаты: например, автопрочитанность, уведомления, бизнес-правила                           | US-007 (разработчик)    | Must      | Разработчик может добавить плагин или хук для обработки события "сообщение отправлено" и выполнить кастомную логику (например, отправка в CRM или триггер на уведомление)        | Плагины, API               |
| **FR-008** | Поддержка нескольких интерфейсов | Система позволяет подключать разные графические интерфейсы (веб, мобильный, десктоп) без изменения логики                           | US-008 (дизайнер)       | Must      | Два разных UI (веб и мобильное приложение) работают с одним движком. Одинаковые данные отображаются корректно                                                                  | UI, API                   |
| **FR-009** | Уведомления в чате           | Система отправляет push- или in-app уведомления о новых сообщениях                                                                        | US-009 (пользователь)  | Should    | При получении нового сообщения: пользователь получает уведомление в течение 1 секунды. Уведомления можно отключить в настройках                                                  | Уведомления, Чаты         |
| **FR-010** | Редактирование сообщений     | Система позволяет редактировать уже отправленные сообщения                                                                              | US-010 (пользователь)  | Could     | Пользователь редактирует сообщение в течение 5 минут после отправки. В истории отображается "редактированное"                                                                  | Чаты, История             |
| **FR-011** | Управление участниками       | Система позволяет добавлять/удалять участников из чата, назначать администраторов                                                         | US-011 (админ)         | Must      | Администратор чата добавляет нового участника. Участник получает уведомление и может начать писать в чат. Удаление участника не удаляет историю                                | Чаты, Пользователи        |
| **FR-012** | Кроссплатформенная синхронизация | Сообщения и статусы синхронизируются между разными клиентами (веб, мобильный, API)                                                   | US-012 (пользователь)  | Must      | При отправке сообщения с мобильного приложения: оно появляется в веб-интерфейсе. Статус прочитанности обновляется на всех устройствах                                        | Синхронизация, API        |
| **FR-013** | API для внешних интеграций   | Система предоставляет REST- или GraphQL-интерфейс для подключения к внешним системам                                                    | US-013 (разработчик)    | Must      | Разработчик вызывает метод `/chat/send`, `/chat/read`, `/chat/list`. Все методы документированы и имеют примеры запросов/ответов                                                  | API, Интеграции           |
| **FR-014** | Поддержка мультитенантности | Система позволяет использовать движок в разных приложениях/проектах, разделяя данные между ними                                          | US-014 (архитектор)    | Should    | Два разных приложения (например, "Мессенджер А" и "Мессенджер Б") используют один движок. Данные не пересекаются между ними                                                    | Мультитенантность, API      |
| **FR-015** | Поддержка кастомных событий | Система позволяет подписываться на события (новое сообщение, участник добавлен, чат удален) и обрабатывать их                            | US-015 (разработчик)    | Must      | Разработчик подписывается на событие `onMessageSent`, `onChatDeleted`. События передаются через WebSocket или webhook                                                          | События, API               |
| **FR-016** | Управление правами в чате    | Система позволяет настраивать права участников (чтение, отправка, удаление, админ)                                                       | US-016 (админ)         | Should    | Участник с правом "только чтение" не может отправить сообщение. Администратор может изменить права других участников                                                            | RBAC, Чаты                |
| **FR-017** | Поиск по сообщениям          | Система позволяет искать по тексту сообщений внутри чата                                                                               | US-017 (пользователь)  | Could     | При поиске "договор" в чате: отображаются все сообщения, содержащие этот текст. Поиск поддерживает регистронезависимость и частичное совпадение                              | Поиск, Чаты               |
| **FR-018** | Аудит действий в чате       | Система ведет журнал действий (кто добавлен, кто удалил сообщение, кто прочитал)                                                        | US-018 (юрист)         | Should    | При удалении сообщения администратором: в аудите записывается ID пользователя, дата, тип действия                                                                              | Логирование, Безопасность |
| **FR-019** | Поддержка кэширования        | Система поддерживает кэширование чатов и сообщений для ускорения работы                                                                  | US-019 (архитектор)    | Could     | При повторном запросе истории чата: данные берутся из кэша, если он актуален. Время отклика уменьшается на 30%                                                                 | Кэширование, Производительность |
| **FR-020** | Локализация и интернационализация | Система поддерживает локализацию интерфейса и сообщений для разных языков и регионов                                                   | US-020 (пользователь)  | Could     | При смене языка интерфейса: все метки, уведомления и сообщения отображаются на нужном языке. Поддержка UTF-8, даты, форматов                                                  | Локализация, UI           |

---
